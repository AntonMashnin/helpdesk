<p align="center"><img src="storage_provider.png"></p>

<div align="center">
  <h4>This is a step-by-step guide to setup your <a href="https://github.com/Joystream/storage-node-joystream">storage node</a>, and get started as a Storage Provider on the latest
  <a href="https://testnet.joystream.org/pioneer">Joystream Testnet</a><h4>
</div>



# Table of contents

- [Overview](#overview)
- [Instructions](#instructions)
    - [Mac & Linux](#mac)
        - [Run a Joystream node](#run-a-joystream-node)
        - [Download and install](#download-and-install)
        - [Generate keys and memberships](#generate-keys-and-memberships)
        - [Configure node](#configure-node)
        - [Start your node](#start-your-node)
- [Troubleshooting](#troubleshooting)


**NOTE**
You can setup the node and signup for the role now, but you will have to update the software before you can actually perform the desired function in the system. We user to only to this for testing purposes at this point.

# Overview

This page contains all information on how to setup your storage node and becoming a `Storage Provider` on the Joystream Testnets. It will be updated for improvements, and when something changes for new testnets.

# Instructions
Note that the software will only run on Mac and Linux. If you are not comfortable using the command line, proceed with caution.

## Mac & Linux

If you are using mac, you need [homebrew](https://brew.sh/) installed on your system. The following packages are required:
```
# On mac
$ brew install npm yarn node git
# On Linux
$ sudo apt-get install npm yarn node git
```
Note that `node` v11.xx will lead to some issues on Linux.

#### Run a Joystream Node
To be a `Storage Provider`, you also have to run a [full node](https://github.com/Joystream/substrate-node-joystream). Instructions can be found [here](https://github.com/Joystream/helpdesk/roles/validators). Note that you can stop after the first setup.

#### Download and install
First you need to clone the repo:
```
$ cd
$ git clone https://github.com/Joystream/storage-node-joystream.git
$ cd storage-node-Joystream
$ yarn run build
$ npm install -g
# You will likely see some errors and warnings now.
# Test if it works with:
$ js_storage --help
# This should list the commands and options available
# If this fails, replace js_storage with ~/storage-node-joystream/bin/cli.js
```
#### Generate keys and memberships

Click [here](https://testnet.joystream.org) to open the `Pioneer app` in your browser. Then follow instructions [here](https://github.com/Joystream/helpdesk#get-started) to generate a set of `Keys`, get tokens, and sign up for a `Membership`. This will `key` will be referred to as the `member` key from now on. Make sure to save the `5YourJoyMemberAddress.json` file. Make sure to select the `Edwards` crypto type. Note that you need to keep the rest of your tokens as stake to become a `Storage Provider`.

#### Sign up for the role

Back in your terminal, you can now sign up for the role:

```
$ js_storage signup /path/to/5YourJoyMemberAddress.json
# Follow the instructions provided in the terminal.
```
This will transfer 3000(stake) + 50 (cost) + 1(tx-fee) Joy tokens from your `member` key to the `storage` key generated by the node. The `5YourStorageAddress.json` file will be saved in `~/storage-node-joystream` folder. Also note that the `storage` key will be an `Edwards` key.

#### Configure node
There are a number of configuration options to set.
```
# First, create a storage repository. It will default to ~/storage-node-joystream/storage
$ js_storage create
# If you want to set another directory:
$ js_storage create --storage=/path/to/storage/directory
# A config file will be produced in the next step.
$ js_storage --help
# Will show default location, and how to change this. (joystream-storage.json)
```

Example output shown below. Notice the first `<four>` characters:
```
Storage created.
Creating repository from template "undefined"...
Repository created with id: <5049ebe0-68b9-59bf-9cff-a6581933f0ef>
You can access this via `/path/to/storage/directory/repos/<50>/<49>/<5049ebe0-68b9-59bf-9cff-a6581933f0ef>
```
This will produce the config file. For now, it will only contain your storage directory.

#### Start your node
You are now ready to start your node:
```
# With default settings:
$ js_storage --key-file 5YourStorageAddress.json
# If you port 3000 is blocked (for example running our Pioneer app locally), you can pass --port=<port>.
```
---

# Troubleshooting
If you had any issues setting it up, you may find your answer here!

TODO
